<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script type="text/javascript">
        var username,password,confirm,email,strength;
        function check()
        {

            if(password.value !=confirm.value)
            {
                alert("Passwords do not match");
                password.focus();
                confirm.value="";
            }
        }
        function init()
        {
            {% if error %}
                alert("Username exists . Please enter a different username");
            {% endif %}
            strength = document.getElementById('strength');
            username=document.getElementById("username");
            password=document.getElementById("password");
            confirm=document.getElementById("confirm");
            email=document.getElementById("email");
        }
        function validate() {

            if (username.value.length == 0) {
                alert("Please enter an username");
                return false;
            }
            var p = /(^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$)/;
            if (!p.test(email.value)) {
                alert("Please enter a valid email");
                return false;

            }
            if(passwordChanged()==0)
            {
                alert("Please Enter stronger password");
                return false;
            }
            return true;
        }
        function passwordChanged() {

                    var strongRegex = new RegExp("^(?=.{8,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*\W).*$", "g");
                    var mediumRegex = new RegExp("^(?=.{7,})(((?=.*[A-Z])(?=.*[a-z]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[0-9]))).*$", "g");
                    var enoughRegex = new RegExp("(?=.{6,}).*", "g");
                    var pwd =password;
                    if (pwd.value.length==0) {
                        strength.innerHTML = 'Please Type a Password';
                        return 0;
                    } else if (false == enoughRegex.test(pwd.value)) {
                        strength.innerHTML = '<span style="color:red">Needs More Characters</span>';
                        return 0;
                    } else if (strongRegex.test(pwd.value)) {
                        strength.innerHTML = '<span style="color:green"> The password is strong!</span>';
                        return 2;
                    } else if (mediumRegex.test(pwd.value)) {
                        strength.innerHTML = '<span style="color:orange">The password is moderate</span>';
                        return 1;
                    } else {
                        strength.innerHTML = '<span style="color:red">The password is weak</span>';
                        return 0;
                    }
}
    </script>
</head>
<body onload="init()">

     <form action="" method="post" onsubmit="return validate()">
		{% if next %}
		<input type="hidden" name="next" value="{{ next }}" />
		{% endif %}
		username:
		<input type="text" id="username" name="username" value="{{ username}}" /><br />
        email:
		<input type="text" id="email" name="email" value="" /><br />
		password:
		<input type="password" id="password" name="password" value="" onkeyup="return passwordChanged()"/> <span id="strength"></span><br />
        confirm password:
        <input type="password" id="confirm" name="confirm" value="" onblur="check()"/><br />
		<input type="submit" value="Register" />
	</form>
</body>

</html>